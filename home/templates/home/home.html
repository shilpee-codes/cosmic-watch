<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CosmicWatch - Real-time Near-Earth Object monitoring with intelligent risk analysis">
  <title>CosmicWatch - NEO Dashboard</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <style>
    /* ==================== CSS VARIABLES ==================== */
:root {
  /* Colors */
  --color-primary: #7df9ff;
  --color-primary-dark: #00d4ff;
  --color-secondary: #b47dff;
  --color-accent: #ff7ddb;
  
  --color-bg-dark: #000000;
  --color-bg-gradient-start: #0a0e27;
  --color-bg-gradient-mid: #1a1f3a;
  --color-card-bg: rgba(17, 22, 51, 0.85);
  --color-nav-bg: rgba(5, 8, 20, 0.95);
  
  --color-text-light: #ffffff;
  --color-text-muted: #b0b8d4;
  --color-text-dim: #7a82a0;
  
  /* Risk Colors */
  --color-risk-low: #00ff88;
  --color-risk-medium: #ffd700;
  --color-risk-high: #ff4757;
  
  /* Spacing */
  --spacing-xs: 8px;
  --spacing-sm: 12px;
  --spacing-md: 20px;
  --spacing-lg: 30px;
  --spacing-xl: 40px;
  
  /* Border Radius */
  --radius-sm: 8px;
  --radius-md: 14px;
  --radius-lg: 20px;
  
  /* Shadows & Glows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
  --glow-primary: 0 0 20px rgba(125, 249, 255, 0.4);
  --glow-high: 0 0 20px rgba(255, 71, 87, 0.5);
  --glow-medium: 0 0 20px rgba(255, 215, 0, 0.5);
  --glow-low: 0 0 20px rgba(0, 255, 136, 0.5);
}

/* ==================== RESET & BASE ==================== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background: var(--color-bg-dark);
  color: var(--color-text-light);
  line-height: 1.6;
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
}

/* ==================== ANIMATED STARFIELD ==================== */
.stars,
.stars2,
.stars3 {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

.stars {
  background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAEklEQVQIW2P4////fwYGBgYACgcD/QmGJhQAAAAASUVORK5CYII=') repeat;
  animation: starsFloat 200s linear infinite;
  opacity: 0.3;
}

.stars2 {
  background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAEklEQVQIW2P4////fwYGBgYACgcD/QmGJhQAAAAASUVORK5CYII=') repeat;
  animation: starsFloat 300s linear infinite;
  opacity: 0.2;
}

.stars3 {
  background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAEklEQVQIW2P4////fwYGBgYACgcD/QmGJhQAAAAASUVORK5CYII=') repeat;
  animation: starsFloat 400s linear infinite;
  opacity: 0.15;
}

@keyframes starsFloat {
  from { transform: translateY(0); }
  to { transform: translateY(-2000px); }
}

/* ==================== NAVIGATION ==================== */
.navbar {
  background: var(--color-nav-bg);
  backdrop-filter: blur(20px) saturate(180%);
  position: sticky;
  top: 0;
  z-index: 1000;
  box-shadow: var(--shadow-md);
  border-bottom: 1px solid rgba(125, 249, 255, 0.1);
}

.nav-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md) var(--spacing-lg);
  max-width: 1400px;
  margin: 0 auto;
}

.logo-container {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.logo-icon {
  font-size: 1.8rem;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.logo {
  font-size: 1.5rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 0;
}

.nav-links {
  display: flex;
  list-style: none;
  gap: var(--spacing-sm);
}

.nav-link {
  color: var(--color-text-muted);
  text-decoration: none;
  padding: var(--spacing-xs) var(--spacing-md);
  border-radius: var(--radius-sm);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
  position: relative;
}

.nav-link .icon {
  font-size: 1.1rem;
}

.nav-link:hover {
  color: var(--color-primary);
  background: rgba(125, 249, 255, 0.1);
  transform: translateY(-2px);
}

.nav-link.active {
  color: var(--color-primary);
  background: rgba(125, 249, 255, 0.15);
  box-shadow: var(--glow-primary);
}

.nav-link.logout-link {
  color: var(--color-risk-high);
}

.nav-link.logout-link:hover {
  color: white;
  background: rgba(255, 71, 87, 0.2);
  box-shadow: var(--glow-high);
}

/* ==================== MAIN CONTAINER ==================== */
.container {
  max-width: 1400px;
  width: 100%;
  margin: 0 auto;
  padding: var(--spacing-lg);
  position: relative;
  z-index: 1;
}

/* ==================== PAGE HEADER ==================== */
.page-header {
  text-align: center;
  margin-bottom: var(--spacing-xl);
  padding: var(--spacing-xl) 0;
}

.main-title {
  font-size: clamp(2rem, 5vw, 3.5rem);
  margin-bottom: var(--spacing-md);
  font-weight: 800;
  letter-spacing: -0.02em;
}

.gradient-text {
  background: linear-gradient(135deg, #7df9ff 0%, #b47dff 50%, #ff7ddb 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gradientShift 5s ease infinite;
  background-size: 200% 200%;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.subtitle {
  color: var(--color-text-muted);
  font-size: clamp(1rem, 2vw, 1.2rem);
  max-width: 700px;
  margin: 0 auto var(--spacing-md);
  font-weight: 400;
}

.header-divider {
  width: 100px;
  height: 3px;
  background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
  margin: var(--spacing-md) auto;
  border-radius: 2px;
}

/* ==================== SUMMARY PANEL ==================== */
.summary-panel {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-xl);
}

.summary-card {
  background: var(--color-card-bg);
  backdrop-filter: blur(10px);
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  text-align: center;
  box-shadow: var(--shadow-md);
  border: 2px solid rgba(125, 249, 255, 0.2);
  position: relative;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.summary-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(125, 249, 255, 0.1), transparent);
  opacity: 0;
  transition: opacity 0.3s;
}

.summary-card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: var(--shadow-lg);
}

.summary-card:hover::before {
  opacity: 1;
}

.summary-card.high {
  border-color: var(--color-risk-high);
}

.summary-card.high:hover {
  box-shadow: var(--glow-high);
}

.summary-card.medium {
  border-color: var(--color-risk-medium);
}

.summary-card.medium:hover {
  box-shadow: var(--glow-medium);
}

.summary-card.low {
  border-color: var(--color-risk-low);
}

.summary-card.low:hover {
  box-shadow: var(--glow-low);
}

.summary-card.total {
  border-color: var(--color-primary);
}

.summary-icon {
  font-size: 2.5rem;
  margin-bottom: var(--spacing-sm);
  filter: drop-shadow(0 0 10px rgba(125, 249, 255, 0.5));
}

.summary-card .count {
  font-size: clamp(2.5rem, 5vw, 3.5rem);
  font-weight: 800;
  margin-bottom: var(--spacing-xs);
  line-height: 1;
}

.summary-card.high .count { color: var(--color-risk-high); }
.summary-card.medium .count { color: var(--color-risk-medium); }
.summary-card.low .count { color: var(--color-risk-low); }
.summary-card.total .count { color: var(--color-primary); }

.summary-card .label {
  color: var(--color-text-muted);
  font-size: 0.95rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Pulse Indicators */
.pulse-indicator {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 8px;
  height: 8px;
  border-radius: 50%;
  animation: pulse 2s ease-in-out infinite;
}

.high-pulse { background: var(--color-risk-high); }
.medium-pulse { background: var(--color-risk-medium); }
.low-pulse { background: var(--color-risk-low); }

@keyframes pulse {
  0%, 100% {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
  50% {
    opacity: 0.5;
    transform: translateX(-50%) scale(1.3);
  }
}

/* ==================== CONTROLS ==================== */
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-xl);
  padding: var(--spacing-md);
  background: var(--color-card-bg);
  backdrop-filter: blur(10px);
  border-radius: var(--radius-md);
  border: 1px solid rgba(125, 249, 255, 0.15);
}

.control-group {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  flex: 1;
  min-width: 200px;
}

.control-group label {
  color: var(--color-text-muted);
  font-weight: 600;
  font-size: 0.9rem;
  white-space: nowrap;
}

.filter-select {
  flex: 1;
  padding: var(--spacing-xs) var(--spacing-sm);
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(125, 249, 255, 0.3);
  border-radius: var(--radius-sm);
  color: var(--color-text-light);
  font-size: 0.95rem;
  cursor: pointer;
  transition: all 0.3s;
}

.filter-select:hover,
.filter-select:focus {
  background: rgba(255, 255, 255, 0.1);
  border-color: var(--color-primary);
  box-shadow: var(--glow-primary);
  outline: none;
}

.refresh-btn {
  padding: var(--spacing-xs) var(--spacing-md);
  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
  border: none;
  border-radius: var(--radius-sm);
  color: var(--color-bg-dark);
  font-weight: 700;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.3s;
  white-space: nowrap;
}

.refresh-btn:hover {
  transform: scale(1.05);
  box-shadow: var(--glow-primary);
}

.refresh-btn:active {
  transform: scale(0.98);
}

/* ==================== GRID LAYOUT ==================== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: var(--spacing-lg);
  margin-bottom: var(--spacing-xl);
}

/* ==================== ASTEROID CARDS ==================== */
.card {
  background: var(--color-card-bg);
  backdrop-filter: blur(15px);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  box-shadow: var(--shadow-md);
  border: 2px solid rgba(125, 249, 255, 0.15);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--color-primary), var(--color-secondary), var(--color-accent));
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.4s;
}

.card:hover::before {
  transform: scaleX(1);
}

.card:hover {
  transform: translateY(-10px);
  box-shadow: var(--shadow-lg), var(--glow-primary);
  border-color: rgba(125, 249, 255, 0.4);
}

.card h2 {
  color: var(--color-primary);
  font-size: 1.4rem;
  margin-bottom: var(--spacing-md);
  font-weight: 700;
  word-wrap: break-word;
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.card h2::before {
  content: '‚òÑÔ∏è';
  font-size: 1.2rem;
}

.card p {
  margin: var(--spacing-xs) 0;
  color: var(--color-text-muted);
  font-size: 0.95rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.card strong {
  color: var(--color-text-light);
  font-weight: 600;
  min-width: 100px;
}

.card .value {
  text-align: right;
  font-family: 'Courier New', monospace;
}

/* Risk Badges */
.risk-badge {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.risk-low,
.low {
  color: var(--color-risk-low);
  background: rgba(0, 255, 136, 0.15);
  border: 1px solid var(--color-risk-low);
}

.risk-medium,
.medium {
  color: var(--color-risk-medium);
  background: rgba(255, 215, 0, 0.15);
  border: 1px solid var(--color-risk-medium);
}

.risk-high,
.high {
  color: var(--color-risk-high);
  background: rgba(255, 71, 87, 0.15);
  border: 1px solid var(--color-risk-high);
  animation: alertPulse 2s ease-in-out infinite;
}

@keyframes alertPulse {
  0%, 100% { box-shadow: 0 0 0 rgba(255, 71, 87, 0); }
  50% { box-shadow: 0 0 15px rgba(255, 71, 87, 0.6); }
}

/* ==================== BUTTONS ==================== */
button {
  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
  color: var(--color-bg-dark);
  border: none;
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-weight: 700;
  font-size: 0.95rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin-top: var(--spacing-md);
  width: 100%;
  position: relative;
  overflow: hidden;
}

button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

button:hover::before {
  width: 300px;
  height: 300px;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: var(--glow-primary);
}

button:active {
  transform: translateY(0);
}

button:focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* ==================== LOADING STATE ==================== */
.loading {
  text-align: center;
  padding: var(--spacing-xl);
}

.loading-container {
  max-width: 400px;
  margin: 0 auto;
}

.spinner {
  width: 60px;
  height: 60px;
  border: 5px solid rgba(125, 249, 255, 0.2);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto var(--spacing-md);
  box-shadow: var(--glow-primary);
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-text {
  color: var(--color-text-muted);
  font-size: 1.1rem;
  margin-bottom: var(--spacing-md);
}

.loading-bar {
  width: 100%;
  height: 4px;
  background: rgba(125, 249, 255, 0.2);
  border-radius: 2px;
  overflow: hidden;
}

.loading-progress {
  height: 100%;
  background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
  animation: progress 1.5s ease-in-out infinite;
}

@keyframes progress {
  0% { width: 0; transform: translateX(0); }
  50% { width: 70%; transform: translateX(0); }
  100% { width: 100%; transform: translateX(100%); }
}

/* ==================== EMPTY STATE ==================== */
.empty-state {
  text-align: center;
  padding: var(--spacing-xl) var(--spacing-md);
}

.empty-icon {
  font-size: 5rem;
  margin-bottom: var(--spacing-md);
  opacity: 0.5;
}

.empty-title {
  color: var(--color-text-light);
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: var(--spacing-sm);
}

.empty-subtitle {
  color: var(--color-text-muted);
  font-size: 1rem;
}

/* ==================== FOOTER ==================== */
.footer {
  background: var(--color-nav-bg);
  backdrop-filter: blur(20px);
  padding: var(--spacing-lg);
  margin-top: var(--spacing-xl);
  border-top: 1px solid rgba(125, 249, 255, 0.1);
  position: relative;
  z-index: 1;
}

.footer-content {
  max-width: 1400px;
  margin: 0 auto;
  text-align: center;
}

.footer-text {
  color: var(--color-text-muted);
  font-size: 0.95rem;
  margin-bottom: var(--spacing-xs);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
}

.footer-update {
  color: var(--color-text-dim);
  font-size: 0.85rem;
}

#last-updated {
  color: var(--color-primary);
  font-weight: 600;
}

/* ==================== RESPONSIVE DESIGN ==================== */
@media (max-width: 768px) {
  .nav-container {
    flex-direction: column;
    gap: var(--spacing-md);
  }
  
  .nav-links {
    width: 100%;
    justify-content: center;
  }
  
  .grid {
    grid-template-columns: 1fr;
  }
  
  .summary-panel {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .controls {
    flex-direction: column;
  }
  
  .control-group {
    width: 100%;
  }
  
  .container {
    padding: var(--spacing-md);
  }
}

@media (max-width: 480px) {
  .summary-panel {
    grid-template-columns: 1fr;
  }
  
  .logo {
    font-size: 1.2rem;
  }
  
  .nav-link {
    font-size: 0.9rem;
  }
}

/* ==================== ACCESSIBILITY ==================== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* ==================== UTILITY CLASSES ==================== */
.icon {
  display: inline-block;
}

.hidden {
  display: none !important;
}
/*here new changes where i add space background*/
/* ==================== CSS VARIABLES ==================== */
:root {
  /* Colors */
  --color-primary: #7df9ff;
  --color-primary-dark: #00d4ff;
  --color-secondary: #b47dff;
  --color-accent: #ff7ddb;
  
  --color-bg-dark: #000000;
  --color-bg-gradient-start: #0a0e27;
  --color-bg-gradient-mid: #1a1f3a;
  --color-card-bg: rgba(17, 22, 51, 0.85);
  --color-nav-bg: rgba(5, 8, 20, 0.95);
  
  --color-text-light: #ffffff;
  --color-text-muted: #b0b8d4;
  --color-text-dim: #7a82a0;
  
  /* Risk Colors */
  --color-risk-low: #00ff88;
  --color-risk-medium: #ffd700;
  --color-risk-high: #ff4757;
  
  /* Spacing */
  --spacing-xs: 8px;
  --spacing-sm: 12px;
  --spacing-md: 20px;
  --spacing-lg: 30px;
  --spacing-xl: 40px;
  
  /* Border Radius */
  --radius-sm: 8px;
  --radius-md: 14px;
  --radius-lg: 20px;
  
  /* Shadows & Glows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
  --glow-primary: 0 0 20px rgba(125, 249, 255, 0.4);
  --glow-high: 0 0 20px rgba(255, 71, 87, 0.5);
  --glow-medium: 0 0 20px rgba(255, 215, 0, 0.5);
  --glow-low: 0 0 20px rgba(0, 255, 136, 0.5);
}

/* ==================== RESET & BASE ==================== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background: #000000;
  color: var(--color-text-light);
  line-height: 1.6;
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
}

/* Space Background with Gradient */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: 
    radial-gradient(ellipse at 20% 30%, rgba(88, 50, 180, 0.3) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 70%, rgba(50, 88, 180, 0.25) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 50%, rgba(180, 50, 150, 0.15) 0%, transparent 60%),
    linear-gradient(to bottom, #0a0520 0%, #000000 50%, #0a0520 100%);
  z-index: -1;
  pointer-events: none;
}

/* ==================== REALISTIC STARFIELD ==================== */
.stars,
.stars2,
.stars3 {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

/* Small stars */
.stars {
  background-image: 
    radial-gradient(2px 2px at 20px 30px, #eee, transparent),
    radial-gradient(2px 2px at 60px 70px, #fff, transparent),
    radial-gradient(1px 1px at 50px 50px, #ddd, transparent),
    radial-gradient(1px 1px at 130px 80px, #fff, transparent),
    radial-gradient(2px 2px at 90px 10px, #fff, transparent),
    radial-gradient(1px 1px at 200px 150px, #eee, transparent),
    radial-gradient(1px 1px at 250px 100px, #fff, transparent),
    radial-gradient(2px 2px at 300px 50px, #ddd, transparent);
  background-repeat: repeat;
  background-size: 350px 250px;
  animation: starsMove 120s linear infinite;
  opacity: 0.8;
}

/* Medium stars */
.stars2 {
  background-image:
    radial-gradient(1px 1px at 100px 120px, #fff, transparent),
    radial-gradient(2px 2px at 180px 60px, #f0f0f0, transparent),
    radial-gradient(1px 1px at 240px 90px, #fff, transparent),
    radial-gradient(2px 2px at 20px 200px, #eee, transparent),
    radial-gradient(1px 1px at 140px 180px, #fff, transparent),
    radial-gradient(1px 1px at 280px 160px, #ddd, transparent);
  background-repeat: repeat;
  background-size: 300px 220px;
  animation: starsMove 180s linear infinite;
  opacity: 0.6;
}

/* Bright twinkling stars */
.stars3 {
  background-image:
    radial-gradient(3px 3px at 50px 100px, rgba(255, 255, 255, 0.9), transparent),
    radial-gradient(2px 2px at 150px 40px, rgba(180, 220, 255, 0.8), transparent),
    radial-gradient(3px 3px at 220px 180px, rgba(255, 240, 200, 0.9), transparent),
    radial-gradient(2px 2px at 80px 220px, rgba(200, 220, 255, 0.7), transparent),
    radial-gradient(3px 3px at 310px 120px, rgba(255, 255, 255, 0.8), transparent);
  background-repeat: repeat;
  background-size: 350px 250px;
  animation: starsMove 240s linear infinite, twinkle 3s ease-in-out infinite;
  opacity: 0.9;
}

@keyframes starsMove {
  from { transform: translateY(0); }
  to { transform: translateY(-2000px); }
}

@keyframes twinkle {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

/* ==================== NAVIGATION ==================== */
.navbar {
  background: var(--color-nav-bg);
  backdrop-filter: blur(20px) saturate(180%);
  position: sticky;
  top: 0;
  z-index: 1000;
  box-shadow: var(--shadow-md);
  border-bottom: 1px solid rgba(125, 249, 255, 0.1);
}

.nav-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-md) var(--spacing-lg);
  max-width: 1400px;
  margin: 0 auto;
}

.logo-container {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.logo-icon {
  font-size: 1.8rem;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.logo {
  font-size: 1.5rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 0;
}

.nav-links {
  display: flex;
  list-style: none;
  gap: var(--spacing-sm);
}

.nav-link {
  color: var(--color-text-muted);
  text-decoration: none;
  padding: var(--spacing-xs) var(--spacing-md);
  border-radius: var(--radius-sm);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
  position: relative;
}

.nav-link .icon {
  font-size: 1.1rem;
}

.nav-link:hover {
  color: var(--color-primary);
  background: rgba(125, 249, 255, 0.1);
  transform: translateY(-2px);
}

.nav-link.active {
  color: var(--color-primary);
  background: rgba(125, 249, 255, 0.15);
  box-shadow: var(--glow-primary);
}

/* ==================== MAIN CONTAINER ==================== */
.container {
  max-width: 1400px;
  width: 100%;
  margin: 0 auto;
  padding: var(--spacing-lg);
  position: relative;
  z-index: 1;
}

/* ==================== PAGE HEADER ==================== */
.page-header {
  text-align: center;
  margin-bottom: var(--spacing-xl);
  padding: var(--spacing-xl) 0;
}

.main-title {
  font-size: clamp(2rem, 5vw, 3.5rem);
  margin-bottom: var(--spacing-md);
  font-weight: 800;
  letter-spacing: -0.02em;
}

.gradient-text {
  background: linear-gradient(135deg, #7df9ff 0%, #b47dff 50%, #ff7ddb 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gradientShift 5s ease infinite;
  background-size: 200% 200%;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.subtitle {
  color: var(--color-text-muted);
  font-size: clamp(1rem, 2vw, 1.2rem);
  max-width: 700px;
  margin: 0 auto var(--spacing-md);
  font-weight: 400;
}

.header-divider {
  width: 100px;
  height: 3px;
  background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
  margin: var(--spacing-md) auto;
  border-radius: 2px;
}

/* ==================== SUMMARY PANEL ==================== */
.summary-panel {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-xl);
}

.summary-card {
  background: var(--color-card-bg);
  backdrop-filter: blur(10px);
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  text-align: center;
  box-shadow: var(--shadow-md);
  border: 2px solid rgba(125, 249, 255, 0.2);
  position: relative;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.summary-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(125, 249, 255, 0.1), transparent);
  opacity: 0;
  transition: opacity 0.3s;
}

.summary-card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: var(--shadow-lg);
}

.summary-card:hover::before {
  opacity: 1;
}

.summary-card.high {
  border-color: var(--color-risk-high);
}

.summary-card.high:hover {
  box-shadow: var(--glow-high);
}

.summary-card.medium {
  border-color: var(--color-risk-medium);
}

.summary-card.medium:hover {
  box-shadow: var(--glow-medium);
}

.summary-card.low {
  border-color: var(--color-risk-low);
}

.summary-card.low:hover {
  box-shadow: var(--glow-low);
}

.summary-card.total {
  border-color: var(--color-primary);
}

.summary-icon {
  font-size: 2.5rem;
  margin-bottom: var(--spacing-sm);
  filter: drop-shadow(0 0 10px rgba(125, 249, 255, 0.5));
}

.summary-card .count {
  font-size: clamp(2.5rem, 5vw, 3.5rem);
  font-weight: 800;
  margin-bottom: var(--spacing-xs);
  line-height: 1;
}

.summary-card.high .count { color: var(--color-risk-high); }
.summary-card.medium .count { color: var(--color-risk-medium); }
.summary-card.low .count { color: var(--color-risk-low); }
.summary-card.total .count { color: var(--color-primary); }

.summary-card .label {
  color: var(--color-text-muted);
  font-size: 0.95rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Pulse Indicators */
.pulse-indicator {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 8px;
  height: 8px;
  border-radius: 50%;
  animation: pulse 2s ease-in-out infinite;
}

.high-pulse { background: var(--color-risk-high); }
.medium-pulse { background: var(--color-risk-medium); }
.low-pulse { background: var(--color-risk-low); }

@keyframes pulse {
  0%, 100% {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
  50% {
    opacity: 0.5;
    transform: translateX(-50%) scale(1.3);
  }
}

/* ==================== CONTROLS ==================== */
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-xl);
  padding: var(--spacing-md);
  background: var(--color-card-bg);
  backdrop-filter: blur(10px);
  border-radius: var(--radius-md);
  border: 1px solid rgba(125, 249, 255, 0.15);
}

.control-group {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  flex: 1;
  min-width: 200px;
}

.control-group label {
  color: var(--color-text-muted);
  font-weight: 600;
  font-size: 0.9rem;
  white-space: nowrap;
}

.filter-select {
  flex: 1;
  padding: var(--spacing-xs) var(--spacing-sm);
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(125, 249, 255, 0.3);
  border-radius: var(--radius-sm);
  color: var(--color-text-light);
  font-size: 0.95rem;
  cursor: pointer;
  transition: all 0.3s;
}

.filter-select:hover,
.filter-select:focus {
  background: rgba(255, 255, 255, 0.1);
  border-color: var(--color-primary);
  box-shadow: var(--glow-primary);
  outline: none;
}

.refresh-btn {
  padding: var(--spacing-xs) var(--spacing-md);
  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
  border: none;
  border-radius: var(--radius-sm);
  color: var(--color-bg-dark);
  font-weight: 700;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.3s;
  white-space: nowrap;
}

.refresh-btn:hover {
  transform: scale(1.05);
  box-shadow: var(--glow-primary);
}

.refresh-btn:active {
  transform: scale(0.98);
}

/* ==================== GRID LAYOUT ==================== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: var(--spacing-lg);
  margin-bottom: var(--spacing-xl);
}

/* ==================== ASTEROID CARDS ==================== */
.card {
  background: var(--color-card-bg);
  backdrop-filter: blur(15px);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  box-shadow: var(--shadow-md);
  border: 2px solid rgba(125, 249, 255, 0.15);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--color-primary), var(--color-secondary), var(--color-accent));
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.4s;
}

.card:hover::before {
  transform: scaleX(1);
}

.card:hover {
  transform: translateY(-10px);
  box-shadow: var(--shadow-lg), var(--glow-primary);
  border-color: rgba(125, 249, 255, 0.4);
}

.card h2 {
  color: var(--color-primary);
  font-size: 1.4rem;
  margin-bottom: var(--spacing-md);
  font-weight: 700;
  word-wrap: break-word;
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.card h2::before {
  content: '‚òÑÔ∏è';
  font-size: 1.2rem;
}

.card p {
  margin: var(--spacing-xs) 0;
  color: var(--color-text-muted);
  font-size: 0.95rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.card strong {
  color: var(--color-text-light);
  font-weight: 600;
  min-width: 100px;
}

.card .value {
  text-align: right;
  font-family: 'Courier New', monospace;
}

/* Risk Badges */
.risk-badge {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.risk-low,
.low {
  color: var(--color-risk-low);
  background: rgba(0, 255, 136, 0.15);
  border: 1px solid var(--color-risk-low);
}

.risk-medium,
.medium {
  color: var(--color-risk-medium);
  background: rgba(255, 215, 0, 0.15);
  border: 1px solid var(--color-risk-medium);
}

.risk-high,
.high {
  color: var(--color-risk-high);
  background: rgba(255, 71, 87, 0.15);
  border: 1px solid var(--color-risk-high);
  animation: alertPulse 2s ease-in-out infinite;
}

@keyframes alertPulse {
  0%, 100% { box-shadow: 0 0 0 rgba(255, 71, 87, 0); }
  50% { box-shadow: 0 0 15px rgba(255, 71, 87, 0.6); }
}

/* ==================== BUTTONS ==================== */
button {
  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
  color: var(--color-bg-dark);
  border: none;
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-weight: 700;
  font-size: 0.95rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin-top: var(--spacing-md);
  width: 100%;
  position: relative;
  overflow: hidden;
}

button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

button:hover::before {
  width: 300px;
  height: 300px;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: var(--glow-primary);
}

button:active {
  transform: translateY(0);
}

button:focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* ==================== LOADING STATE ==================== */
.loading {
  text-align: center;
  padding: var(--spacing-xl);
}

.loading-container {
  max-width: 400px;
  margin: 0 auto;
}

.spinner {
  width: 60px;
  height: 60px;
  border: 5px solid rgba(125, 249, 255, 0.2);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto var(--spacing-md);
  box-shadow: var(--glow-primary);
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-text {
  color: var(--color-text-muted);
  font-size: 1.1rem;
  margin-bottom: var(--spacing-md);
}

.loading-bar {
  width: 100%;
  height: 4px;
  background: rgba(125, 249, 255, 0.2);
  border-radius: 2px;
  overflow: hidden;
}

.loading-progress {
  height: 100%;
  background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
  animation: progress 1.5s ease-in-out infinite;
}

@keyframes progress {
  0% { width: 0; transform: translateX(0); }
  50% { width: 70%; transform: translateX(0); }
  100% { width: 100%; transform: translateX(100%); }
}

/* ==================== EMPTY STATE ==================== */
.empty-state {
  text-align: center;
  padding: var(--spacing-xl) var(--spacing-md);
}

.empty-icon {
  font-size: 5rem;
  margin-bottom: var(--spacing-md);
  opacity: 0.5;
}

.empty-title {
  color: var(--color-text-light);
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: var(--spacing-sm);
}

.empty-subtitle {
  color: var(--color-text-muted);
  font-size: 1rem;
}

/* ==================== FOOTER ==================== */
.footer {
  background: var(--color-nav-bg);
  backdrop-filter: blur(20px);
  padding: var(--spacing-lg);
  margin-top: var(--spacing-xl);
  border-top: 1px solid rgba(125, 249, 255, 0.1);
  position: relative;
  z-index: 1;
}

.footer-content {
  max-width: 1400px;
  margin: 0 auto;
  text-align: center;
}

.footer-text {
  color: var(--color-text-muted);
  font-size: 0.95rem;
  margin-bottom: var(--spacing-xs);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
}

.footer-update {
  color: var(--color-text-dim);
  font-size: 0.85rem;
}

#last-updated {
  color: var(--color-primary);
  font-weight: 600;
}

/* ==================== RESPONSIVE DESIGN ==================== */
@media (max-width: 768px) {
  .nav-container {
    flex-direction: column;
    gap: var(--spacing-md);
  }
  
  .nav-links {
    width: 100%;
    justify-content: center;
  }
  
  .grid {
    grid-template-columns: 1fr;
  }
  
  .summary-panel {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .controls {
    flex-direction: column;
  }
  
  .control-group {
    width: 100%;
  }
  
  .container {
    padding: var(--spacing-md);
  }
}

@media (max-width: 480px) {
  .summary-panel {
    grid-template-columns: 1fr;
  }
  
  .logo {
    font-size: 1.2rem;
  }
  
  .nav-link {
    font-size: 0.9rem;
  }
}

/* ==================== ACCESSIBILITY ==================== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* ==================== UTILITY CLASSES ==================== */
.icon {
  display: inline-block;
}

.hidden {
  display: none !important;
}

/* ==================== COMMENTS SECTION ==================== */
.comments-section {
  margin-top: var(--spacing-xl);
  padding: var(--spacing-xl);
  background: var(--color-card-bg);
  backdrop-filter: blur(10px);
  border-radius: var(--radius-lg);
  border: 1px solid rgba(255, 255, 255, 0.1);
  position: relative;
  z-index: 1;
}

.comments-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-lg);
  padding-bottom: var(--spacing-md);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.comments-title {
  font-size: 1.8rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 0;
}

.comments-count {
  color: var(--color-text-muted);
  font-size: 1rem;
}

.comment-form {
  margin-bottom: var(--spacing-xl);
}

.form-group {
  margin-bottom: var(--spacing-md);
}

.form-group label {
  display: block;
  color: var(--color-text-muted);
  font-weight: 500;
  margin-bottom: var(--spacing-xs);
}

.form-textarea {
  width: 100%;
  padding: var(--spacing-sm) var(--spacing-md);
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(125, 249, 255, 0.2);
  border-radius: var(--radius-sm);
  color: var(--color-text-light);
  font-size: 1rem;
  font-family: inherit;
  transition: all 0.3s ease;
  resize: vertical;
  min-height: 100px;
}

.form-textarea:focus {
  outline: none;
  border-color: var(--color-primary);
  box-shadow: var(--glow-primary);
}

.submit-btn {
  padding: var(--spacing-sm) var(--spacing-xl);
  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
  color: var(--color-bg-dark);
  border: none;
  border-radius: var(--radius-sm);
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: var(--shadow-md);
}

.submit-btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--glow-primary), var(--shadow-lg);
}

.comments-list {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.comment {
  padding: var(--spacing-md);
  background: rgba(255, 255, 255, 0.03);
  border-radius: var(--radius-md);
  border-left: 3px solid var(--color-primary);
  transition: all 0.3s ease;
}

.comment:hover {
  background: rgba(255, 255, 255, 0.05);
  transform: translateX(5px);
}

.comment-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-sm);
}

.comment-author {
  font-weight: 600;
  color: var(--color-primary);
}

.comment-date {
  color: var(--color-text-dim);
  font-size: 0.85rem;
}

.comment-text {
  color: var(--color-text-muted);
  line-height: 1.6;
}
  </style>
</head>
<body>
  <!-- Animated Background Stars -->
  <div class="stars"></div>
  <div class="stars2"></div>
  <div class="stars3"></div>

  <!-- Navigation -->
  <nav class="navbar" role="navigation" aria-label="Main navigation">
    <div class="nav-container">
      <div class="logo-container">
        <span class="logo-icon">üåå</span>
        <h2 class="logo">CosmicWatch</h2>
      </div>
      <ul class="nav-links">
        <li><a href="index.html" class="nav-link active" aria-current="page">
          <span class="icon">üè†</span> Dashboard
        </a></li>
        <li><a href="watchlist.html" class="nav-link">
          <span class="icon">‚≠ê</span> Watchlist
        </a></li>
        {% if user.is_authenticated %}
        <li><a href="{% url 'logout' %}" class="nav-link logout-link">
          <span class="icon">üö™</span> Logout
        </a></li>
        {% else %}
        <li><a href="{% url 'login' %}" class="nav-link">
          <span class="icon">üë§</span> Login
        </a></li>
        {% endif %}
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container">
    <!-- Page Header -->
    <header class="page-header">
      <h1 class="main-title">
        <span class="gradient-text">Near-Earth Asteroid Monitor</span>
      </h1>
      <p class="subtitle">
        üõ∞Ô∏è Live NASA asteroid tracking with intelligent risk analysis
      </p>
      <div class="header-divider"></div>
    </header>

    <!-- Summary Dashboard -->
    <section class="summary-panel" aria-label="Risk summary statistics">
      <div class="summary-card high">
        <div class="summary-icon">‚ö†Ô∏è</div>
        <h3 id="high-count" class="count">0</h3>
        <p class="label">High Risk</p>
        <div class="pulse-indicator high-pulse"></div>
      </div>

      <div class="summary-card medium">
        <div class="summary-icon">‚ö°</div>
        <h3 id="medium-count" class="count">0</h3>
        <p class="label">Moderate</p>
        <div class="pulse-indicator medium-pulse"></div>
      </div>

      <div class="summary-card low">
        <div class="summary-icon">‚úì</div>
        <h3 id="low-count" class="count">0</h3>
        <p class="label">Low Risk</p>
        <div class="pulse-indicator low-pulse"></div>
      </div>

      <div class="summary-card total">
        <div class="summary-icon">üåç</div>
        <h3 id="total-count" class="count">0</h3>
        <p class="label">Total Tracked</p>
      </div>
    </section>

    <!-- Filters & Controls -->
    <section class="controls">
      <div class="control-group">
        <label for="filter-risk">Filter by Risk:</label>
        <select id="filter-risk" class="filter-select">
          <option value="all">All Asteroids</option>
          <option value="high">High Risk Only</option>
          <option value="medium">Moderate Risk</option>
          <option value="low">Low Risk</option>
        </select>
      </div>
      <div class="control-group">
        <label for="sort-by">Sort by:</label>
        <select id="sort-by" class="filter-select">
          <option value="distance">Distance</option>
          <option value="size">Size</option>
          <option value="velocity">Velocity</option>
          <option value="name">Name</option>
        </select>
      </div>
      <button id="refresh-btn" class="refresh-btn">
        <span class="icon">üîÑ</span> Refresh Data
      </button>
    </section>

    <!-- Loading State -->
    <div id="loading" class="loading" style="display: none;">
      <div class="loading-container">
        <div class="spinner"></div>
        <p class="loading-text">Fetching live asteroid telemetry‚Ä¶</p>
        <div class="loading-bar">
          <div class="loading-progress"></div>
        </div>
      </div>
    </div>

    <!-- Asteroid Grid -->
    <section id="asteroid-container" class="grid" aria-label="Asteroid list"></section>

    <!-- Empty State -->
    <div id="empty-state" class="empty-state" style="display: none;">
      <div class="empty-icon">üåë</div>
      <p class="empty-title">No Asteroids Found</p>
    </div>

    <!-- Comments Section -->
    <section class="comments-section" id="comments">
      <div class="comments-header">
        <h2 class="comments-title">üí¨ Community Discussion</h2>
        <span class="comments-count" id="comment-count">0 comments</span>
      </div>

      <!-- Comment Form (only for authenticated users) -->
      <form class="comment-form" id="comment-form" style="display: none;">
        <div class="form-group">
          <label for="comment-text">Your Comment</label>
          <textarea 
            id="comment-text" 
            class="form-textarea" 
            placeholder="Share your thoughts about asteroid tracking..."
            required
          ></textarea>
        </div>
        <button type="submit" class="submit-btn">Post Comment</button>
      </form>

      <!-- Login prompt for unauthenticated users -->
      <div id="comment-login-prompt" style="display: none; padding: var(--spacing-lg); background: rgba(125, 249, 255, 0.1); border-radius: var(--radius-md); text-align: center;">
        <p style="color: var(--color-text-muted); margin-bottom: var(--spacing-md);">Please <a href="{% url 'login' %}" style="color: var(--color-primary); text-decoration: none;">login</a> to post comments.</p>
      </div>

      <!-- Comments List -->
      <div class="comments-list" id="comments-list">
        <!-- Comments will be dynamically loaded here -->
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <p class="footer-text">
        <span class="icon">üõ∞Ô∏è</span> Data provided by NASA NeoWs API
      </p>
      <p class="footer-update">
        Last updated: <span id="last-updated">--</span>
      </p>
    </div>
  </footer>

  <script src="{% static 'js/main.js' %}"></script>

  <script>
    const COMMENTS_API = "{% url 'comments_api' %}";
    const isAuthenticated = {{ request.user.is_authenticated|lower }};
    const username = "{{ request.user.username }}";

    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }

    function formatTimeAgo(isoDate) {
      const now = new Date();
      const date = new Date(isoDate);
      const secondsAgo = Math.floor((now - date) / 1000);
      if (secondsAgo < 60) return 'Just now';
      if (secondsAgo < 3600) return `${Math.floor(secondsAgo / 60)}m ago`;
      if (secondsAgo < 86400) return `${Math.floor(secondsAgo / 3600)}h ago`;
      return `${Math.floor(secondsAgo / 86400)}d ago`;
    }

    async function loadComments() {
      try {
        const res = await fetch(COMMENTS_API, { credentials: 'same-origin' });
        if (!res.ok) throw new Error('Failed to load');
        const data = await res.json();
        const list = document.getElementById('comments-list');
        const count = document.getElementById('comment-count');

        if (!data.comments || data.comments.length === 0) {
          list.innerHTML = '<div style="text-align: center; padding: var(--spacing-lg); color: var(--color-text-muted);">No comments yet. Be the first to share your thoughts!</div>';
          count.textContent = '0 comments';
          return;
        }

        list.innerHTML = data.comments.map(c => `
          <div class="comment">
            <div class="comment-header">
              <span class="comment-author">üë§ ${c.author}</span>
              <span class="comment-date">${formatTimeAgo(c.created_at)}</span>
            </div>
            <p class="comment-text">${c.text}</p>
          </div>
        `).join('');
        
        count.textContent = `${data.comments.length} comment${data.comments.length !== 1 ? 's' : ''}`;
      } catch (e) {
        console.error('Failed to load comments', e);
      }
    }

    // Show/hide form based on auth status
    window.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('comment-form');
      const prompt = document.getElementById('comment-login-prompt');
      if (isAuthenticated) {
        form.style.display = 'block';
        prompt.style.display = 'none';
      } else {
        form.style.display = 'none';
        prompt.style.display = 'block';
      }
      loadComments();
    });

    // Handle comment submission
    document.getElementById('comment-form')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const textarea = document.getElementById('comment-text');
      const text = textarea.value.trim();
      if (!text) return;

      const csrftoken = getCookie('csrftoken');
      try {
        const res = await fetch(COMMENTS_API, {
          method: 'POST',
          credentials: 'same-origin',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': csrftoken
          },
          body: JSON.stringify({ text })
        });
        if (!res.ok) {
          alert('Failed to post comment');
          return;
        }
        textarea.value = '';
        loadComments();
      } catch (e) {
        console.error('Failed to submit comment', e);
        alert('Failed to post comment');
      }
    });
  </script>
</body>
</html>